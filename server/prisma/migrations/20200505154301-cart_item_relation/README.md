# Migration `20200505154301-cart_item_relation`

This migration has been generated by Richard Roncancio at 5/5/2020, 3:43:01 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."cart_items" (
"created_at" timestamp(3)   DEFAULT CURRENT_TIMESTAMP,"id" SERIAL,"item_id" integer  NOT NULL ,"quantity" integer   DEFAULT 1,"updated_at" timestamp(3)   DEFAULT CURRENT_TIMESTAMP,"userId" integer  NOT NULL ,
    PRIMARY KEY ("id"))

CREATE  INDEX "cart_items_item_id_foreign" ON "public"."cart_items"("item_id")

CREATE  INDEX "cart_items_user_id_foreign" ON "public"."cart_items"("userId")

ALTER TABLE "public"."cart_items" ADD FOREIGN KEY ("item_id")REFERENCES "public"."items"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."cart_items" ADD FOREIGN KEY ("userId")REFERENCES "public"."users"("id") ON DELETE CASCADE  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200503150618-items_user_required..20200505154301-cart_item_relation
--- datamodel.dml
+++ datamodel.dml
@@ -1,7 +1,7 @@
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url      = env("DATABASE_URL")
 }
 generator client {
   provider = "prisma-client-js"
@@ -26,8 +26,9 @@
   createdAt   DateTime?           @map("created_at") @default(now())
   updatedAt   DateTime?           @map("updated_at") @default(now())
   permissions Permission[]
   items       Item[]
+  cart        CartItem[]
   // permissions Role[]              @relation(references: [name])
   // cart_items  cart_items[]
   // order_items order_items[]
   // orders      orders[]
@@ -60,26 +61,28 @@
   createdAt   DateTime?     @map("created_at") @default(now())
   updatedAt   DateTime?     @map("updated_at") @default(now())
   userId      Int           @map("user_id")
   user        User          @relation(fields: [userId], references: [id])
+  cart        CartItem[]
   @@map("items")
   // @@index([userId], name: "items_user_id_foreign")
 }
-// model cart_items {
-//   created_at DateTime?
-//   id         Int       @default(autoincrement()) @id
-//   item_id    Int?
-//   quantity   Int?      @default(1)
-//   updated_at DateTime?
-//   user_id    Int?
-//   items      items?    @relation(fields: [item_id], references: [id])
-//   users      users?    @relation(fields: [user_id], references: [id])
+model CartItem {
+  id         Int              @default(autoincrement()) @id
+  quantity   Int?             @default(1)
+  createdAt  DateTime?        @map("created_at") @default(now())
+  updatedAt  DateTime?        @map("updated_at") @default(now())
+  itemId     Int              @map("item_id")
+  userId     Int
+  item       Item             @relation(fields: [itemId], references: [id])
+  user       User             @relation(fields: [userId], references: [id])
-//   @@index([item_id], name: "cart_items_item_id_foreign")
-//   @@index([user_id], name: "cart_items_user_id_foreign")
-// }
+  @@map("cart_items")
+  @@index([itemId], name: "cart_items_item_id_foreign")
+  @@index([userId], name: "cart_items_user_id_foreign")
+}
 // model items {
 //   created_at  DateTime?
 //   description String
```


